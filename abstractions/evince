# vim:syntax=apparmor
#
# abstraction used by evince binaries
#

  #include <abstractions/audio>
  #include <abstractions/bash>
  #include <abstractions/cups-client>
  #include <abstractions/dbus>
  #include <abstractions/freedesktop.org>
  #include <abstractions/gnome>
  #include <abstractions/nameservice>
  #include <abstractions/launchpad-integration>
  #include <abstractions/private-files-strict>

  @{PROC}/[0-9]*/fd/ r,

  # move out to gnome abstraction if anyone else needs these
  /dev/.udev/db/* r,

  # evince specific
  /etc/ r,
  /etc/fstab r,
  /etc/xpdf/* r,

  /usr/bin/bug-buddy px,
  /usr/bin/gs-esp ixr,
  /usr/bin/yelp Ux,
  /bin/gzip ixr,

  /usr/lib/ghostscript/** mr,
  /usr/share/applications/** r,
  /usr/share/evince/** r,
  /usr/share/ghostscript/** r,
  /usr/share/xpdf/** r,

  # from http://live.gnome.org/Evince/SupportedDocumentFormats. Allow
  # read for all supported file formats
  /**.[bB][mM][pP]     r,
  /**.[dD][jJ][vV][uU] r,
  /**.[dD][vV][iI]     r,
  /**.[gG][iI][fF]     r,
  /**.[jJ][pP][gG]     r,
  /**.[jJ][pP][eE][gG] r,
  /**.[oO][dD][pP]     r,
  /**.[pP][dD][fF]     r,
  /**.[pP][nN][mM]     r,
  /**.[pP][nN][gG]     r,
  /**.[pP][sS]         r,
  /**.[tT][iI][fF][fF] r,
  /**.[xX][pP][mM]     r,
  /**.[gG][zZ]         r,

